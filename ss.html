<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Shooting Game</title>
    <style>
        canvas {
            border: 1px solid black;
            display: block;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <script src="game.js"></script>
    <script>
  const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

// 플레이어 객체
const player = {
    x: canvas.width / 2,
    y: canvas.height - 30,
    width: 50,
    height: 10,
    speed: 7
};

// 총알 객체
const bullet = {
    x: 0,
    y: 0,
    radius: 5,
    speed: 5,
    fired: false
};

// 적 객체
const enemy = {
    x: Math.random() * (canvas.width - 30),
    y: 0,
    width: 30,
    height: 30,
    speed: 2,
    alive: true
};

let score = 0;

// 키 입력 처리
let rightPressed = false;
let leftPressed = false;

document.addEventListener('keydown', keyDownHandler);
document.addEventListener('keyup', keyUpHandler);

function keyDownHandler(e) {
    if (e.key === 'Right' || e.key === 'ArrowRight') {
        rightPressed = true;
    } else if (e.key === 'Left' || e.key === 'ArrowLeft') {
        leftPressed = true;
    } else if (e.key === ' ' && !bullet.fired) {
        fireBullet();
    }
}

function keyUpHandler(e) {
    if (e.key === 'Right' || e.key === 'ArrowRight') {
        rightPressed = false;
    } else if (e.key === 'Left' || e.key === 'ArrowLeft') {
        leftPressed = false;
    }
}

// 플레이어 이동
function movePlayer() {
    if (rightPressed && player.x < canvas.width - player.width) {
        player.x += player.speed;
    } else if (leftPressed && player.x > 0) {
        player.x -= player.speed;
    }
}

// 총알 발사
function fireBullet() {
    bullet.x = player.x + player.width / 2;
    bullet.y = player.y;
    bullet.fired = true;
}

// 총알 이동
function moveBullet() {
    if (bullet.fired) {
        bullet.y -= bullet.speed;
        if (bullet.y < 0) {
            bullet.fired = false;
        }
    }
}

// 적 이동
function moveEnemy() {
    if (enemy.alive) {
        enemy.y += enemy.speed;
        if (enemy.y > canvas.height) {
            enemy.y = 0;
            enemy.x = Math.random() * (canvas.width - enemy.width);
        }
    }
}

// 충돌 감지
function detectCollisions() {
    if (
        bullet.fired &&
        bullet.x > enemy.x &&
        bullet.x < enemy.x + enemy.width &&
        bullet.y > enemy.y &&
        bullet.y < enemy.y + enemy.height
    ) {
        score++;
        bullet.fired = false;
        enemy.alive = false;
        setTimeout(() => {
            enemy.alive = true;
            enemy.y = 0;
            enemy.x = Math.random() * (canvas.width - enemy.width);
        }, 1000);
    }
}

// 게임 상태 업데이트
function updateGame() {
    movePlayer();
    moveBullet();
    moveEnemy();
    detectCollisions();
}

// 게임 화면 그리기
function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    // 플레이어 그리기
    ctx.beginPath();
    ctx.rect(player.x, player.y, player.width, player.height);
    ctx.fillStyle = '#0095DD';
    ctx.fill();
    ctx.closePath();
    // 총알 그리기
    if (bullet.fired) {
        ctx.beginPath();
        ctx.arc(bullet.x, bullet.y, bullet.radius, 0, Math.PI * 2);
        ctx.fillStyle = '#0095DD';
        ctx.fill();
        ctx.closePath();
    }
    // 적 그리기
    if (enemy.alive) {
        ctx.beginPath();
        ctx.rect(enemy.x, enemy.y, enemy.width, enemy.height);
        ctx.fillStyle = '#FF0000';
        ctx.fill();
        ctx.closePath();
    }
    // 점수 표시
    ctx.font = '16px Arial';
    ctx.fillStyle = '#0095DD';
    ctx.fillText('Score: ' + score, 8, 20);
}

// 게임 루프
function gameLoop() {
    updateGame();
    draw();
    requestAnimationFrame(gameLoop);
}

// 게임 시작
gameLoop();
</body>
</html>